# Command

**InfiniteMITM 0.3.0** has introduced `commands` support in its `mitm.yaml` configuration for `request` and `response`. This feature allows the execution of a list of custom commands (such as scripts) before running the defined handler. Although primarily intended for advanced developers, this option is mainly designed to facilitate the use of **InfiniteVariantTool**. This tool packs XML files into binary format (bond format) and vice versa, before they are submitted by the client or received by the game.

For more information about **InfiniteVariantTool**, please visit their official [GitHub repository](https://github.com/soupstream/InfiniteVariantTool).

## Before

In the following example, the `before.commands.run` command will pack an existing XML file (previously unpacked using **InfiniteVariantTool**) into a binary format before returning it to the game. Please note that **InfiniteVariantTool** must be downloaded beforehand.

```yaml
domains:
  # blobs-infiniteugc.svc.halowaypoint.com
  blobs:
    - path: "/ugcstorage/enginegamevariant/:guid/:guid/:egv-bin"
      methods:
        - GET
      response:
        before:
          commands:
            - run:
              # Run InfiniteVariantToolCLI.exe to pack the file and output it using ":egv-bin" as the output filename
              - ":mitm-dir/tools/InfiniteVariantToolCLI/InfiniteVariantToolCLI.exe bond pack"
              - ":mitm-dir/resources/ugc/enginegamevariants/FFA-MITM.xml --output"
              - ":mitm-dir/resources/ugc/enginegamevariants/$3"
        # Output file generated by InfiniteVariantToolCLI.exe
        body: ":mitm-dir/resources/ugc/enginegamevariants/$3"
```
